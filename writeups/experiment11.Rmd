---
title: "Sorites Experiment 11"
output:
  pdf_document:
    toc: true
    highlight: zenburn
    toc_depth: 3
---

```{r load libraries, echo=F, message=F, warning=F}
library(rjson)
library(fitdistrplus)
library(ggplot2)
library(dplyr)
library(tidyr)
library(grid)
library(ggthemes)
library(languageR)
library(psych)
library(lme4)
library(lmerTest)
library(diagram)
library(boot)
char = as.character
num = function(x) {return(as.numeric(char(x)))}
grab = function(colname) { return(function(lst) { return(unlist(lst[[colname]])) }) }
options(digits=3)
mean.sd = funs(mean, sd)
```

## Description of experiment

A copy of the experiment can be found at: [`experiments/experiment11/exp3-sorites.html`](../experiments/experiment10/exp3-sorites.html).

This was run in June of 2015. The design was identical to [Experiment 10](experiment10.pdf) but used the relative clause phrasing for the inductive premise.

For each of the 5 items, there were 5 possible concrete premise sentences and 5 possible inductive premise sentences. So each participant rating 50 sentences.

## Results

There were 30 participants.

```{r, echo=F, message=F, warning=F, fig.width=8, fig.height=3}
d0 = read.csv('../data/experiment10.csv') %>%
  rename(questions=Answer.responses) %>%
  select(workerid, questions)

questions = sapply(char(d0$questions), fromJSON)
n0 = length(questions)
nqns = nrow(questions)
nsubj = ncol(questions)
graball = function(colname) {
  return(unlist(sapply(1:n0, function(i) {
    return((grab(colname))(questions[[i]])) }))) }
d0 = data.frame(qType = graball('qtype'),
                item = graball('object'),
                dollarAmt = graball('dollar_amount'),
                phrasing = graball('phrasing'),
                response = graball('response'),
                workerid = rep(d0$workerid, rep(nqns, length(d0$workerid)))) %>%
  mutate(dollarAmt = as.numeric(sub('\\$','',as.character(dollarAmt))),
         response = as.integer(response),
         workerid = as.factor(workerid))

samplemean <- function(x, d) {
  return(mean(x[d]))
}
ci = function(vals) {
  cis = boot.ci(boot(vals, samplemean, 1000), type="bca")
  low = cis$bca[1,4]
  high = cis$bca[1,5]
  return(data.frame(mean=mean(vals),
                    ci.low=low,
                    ci.high=high,
                    N=length(vals)))
}

aggr = d0 %>% group_by(item, dollarAmt, qType) %>%
#   summarise(response = mean(response)) %>%
  do(ci(.$response)) %>%
  rename(response=mean) %>% as.data.frame
ggplot(aggr, aes(x=dollarAmt, y=response, colour=item, linetype=qType)) +
  geom_point() +
  geom_line() +
  geom_errorbar(aes(x=dollarAmt, ymin=ci.low, ymax=ci.high), width=0) +
  facet_grid(~ item, scale='free') +
  scale_y_continuous(breaks = 1:9, limits=c(1, 9)) +
  theme_few() + scale_colour_few()
```

## Model fit