---
title: "Sorites Prior Elicitations"
author: "Erin Bennett"
header-includes:
   - \usepackage{tikz}
   - \usetikzlibrary{bayesnet}
output: html_document
---

```{r global_options, include=FALSE}
rm(list = ls())
knitr::opts_chunk$set(echo = F, warning = F, cache = F, message = F,
                      sanitiz = F, fig.width = 5, fig.height = 3)
```

```{r load_experiment_data_and_libraries, message=F, warning=F}
source("utils.R")
source("reformatting_data.R")
source("plot_model_results.R")
df = load_sorites()
give_a_number = load_give_a_number() %>%
  mutate(src = "data")
prior_bins = load_priors()
```


## Discretization

As discussed in `data_summary.html`, there were different prices used in the designs for different experiments. Since the range of prices is so wide, and since some prices are very close together, it would be difficult to create a discretization that works for every dollar amount used across all experiments. Because of this, I have implemented a separate discretization for each experiment.

The discretization works by creating a set of bins (not necessarily of equal width) such that each price in the experiment falls into a unique bin. There must also be bins below the lowest price's bin and above the highest price's bin. The probability of each bin is computed from the cdf: `prob_bin = pnorm(upper_boundary) - pnorm(lower_boundary)`. The probability of theta falling between prices from adjacent bins depends on the widths of those bins (and also the cdf, but I'm ignoring that for now).

Here's an example of a discretization for experiment labeled "07c".

Bins are shown divided by vertical lines. The midpoints of the bins, used as the value, appear in black. The thetas, which appear at the boundaries of the bins, are shown in grey. The height of the bars represent the probability that theta will fall between each pair of midpoints.

```{r discretization, fig.width=10, fig.height=2}
print(plot_bins())
```

## Likert responses

For a linking function from S1 endorsement probabilities to Likert scale responses, I use a binomial with parameter equal to the endorsement probability. So for endorsement probability 0.7, the expected distribution of Likert responses would be

```{r likert, fig.width=3, fig.height=1.75}
expand.grid(e = seq(0.1, 0.9, 0.1),
            r = seq(0, 9, 1)) %>%
  mutate(p = dbinom(r, 9, e)) %>%
  filter(abs(e - 0.7) < 0.001) %>%
  ggplot() +
  aes(x=r, y=p) +
  ylab("probability") +
  xlab("response") +
  # facet_wrap(~e) +
  geom_bar(stat="identity")
```


## Sorites premises

```{r}
# sanity check that we fit the priors
model_results_file =
  "../models/results/results-S1-500_burn250_lag1_chain1_concrete_inductive_bins_all_listener0_normed_rating_ignore_last_bin.csv"
  # "../models/results/results-S1-50_burn25_lag1_chain1_concrete_inductive_bins_all_listener0_normed_rating_ignore_last_bin.csv"
  # "../models/results/results-S1-10000_burn5000_lag20_chain1_concrete_inductive_bins_11_listener0_normed_rating_ignore_last_bin.csv" # 20 mins
  # "../models/results/results-S1-10000_burn5000_lag20_chain1_concrete_inductive_bins_11_listener0_normed_rating_ignore_last_bin.csv"
  # "../models/results/results-S1-10000_burn5000_lag20_chain1_bins_listener0_normed_rating_ignore_last_bin.csv" # 
  # "../models/results/results-S1-5000_burn2500_lag10_chain1_bins_listener0_normed_rating_ignore_last_bin.csv" # 10 mins
priors_results = plot_priors(model_results_file)
```

If we fit to just the best bins prior elicitation, then with 5K iterations, we recover the prior with $R^2 = `r round(priors_results$bins_r_squared, 3)`$



```{r, fig.width=15, fig.height=3}
priors_results$last_bins_ecdf
ggsave("img/priors_fit_to_last_bins_and_sorites.png", width=15, height=3)
```

```{r, fig.width=15, fig.height=8}
concrete_results = plot_concrete(model_results_file, zscore=F)
inductive_results = plot_inductive(model_results_file, zscore=F)
sorites_results = concrete_results$df %>%
  mutate(qtype="concrete") %>%
  rbind(inductive_results$df %>% mutate(qtype="inductive")) %>%
  filter(expt_id=="11") #%>%
  # gather("region", "prob", c(y, ymin, ymax)) %>%
  # group_by(object, src) %>%
  # mutate(prob = ifelse(src=="data", (prob-min(prob))/(max(prob) - min(prob)), prob)) %>%
  # ungroup() %>%
  # spread(region, prob)
sorites_results %>%
  ggplot() +
  aes(x=dollar_amount, y=y, ymin=ymin, ymax=ymax,
      colour=src) +
  geom_line() +
  geom_pointrange() +
  facet_wrap(qtype~object, scale="free_x", ncol = 5) +
  scale_colour_solarized()
ggsave("img/l0_fit_to_bins_and_sorites.png", width=15, height=8)
```


```{r, fig.width=10, fig.height=4}
concrete_results = plot_concrete(model_results_file, zscore=T)
inductive_results = plot_inductive(model_results_file, zscore=T)
sorites_results = concrete_results$df %>%
  mutate(qtype="concrete") %>%
  rbind(inductive_results$df %>% mutate(qtype="inductive")) %>%
  filter(expt_id=="11") %>%
  gather("region", "prob", c(y, ymin, ymax)) %>%
  unite("variable", src, region) %>%
  spread(variable, prob)
sorites_results %>%
  ggplot() +
  aes(x=model_y, xmin=model_ymin, xmax=model_ymax,
      y=data_y, ymin=data_ymin, ymax=data_ymax,
      colour=object) +
  geom_errorbarh() +
  geom_pointrange() +
  facet_wrap(~qtype, scales="free") +
  scale_colour_solarized()
ggsave("img/l0_fit_to_bins_and_sorites_cor.png", width=10, height=4)
```

```{r}
inductive_r_squared = sorites_results %>% filter(qtype=="inductive") %>% with(cor(model_y, data_y)^2)
concrete_r_squared = sorites_results %>% filter(qtype=="concrete") %>% with(cor(model_y, data_y)^2)
inductive_r_squared
concrete_r_squared
```


```{r}
read.csv(
  model_results_file,
  col.names = c("result_type", "specifics",
                "expt_id", "object",
                "value", "probability")) %>%
  filter(result_type == "global_param", specifics == "speakerOptimality") %>%
  select(value) %>%
  ggplot(aes(x=value)) + geom_histogram(bins=30)
ggsave("img/l0_fit_to_bins_and_sorites_speakerOptimality.png", width=3, height=2)
```



```{r, fig.width=10, fig.height=2}
# # # this takes ~25 minutes to run
# # model_results_file = "../models/results/results-S1-5000_burn2500_lag10_chain1_concrete_giveanumber_inductive_all_listener0.csv"
# # priors_results = plot_priors(model_results_file)
# # concrete_results = plot_concrete(model_results_file)
# # inductive_results = plot_inductive(model_results_file)
# # l0_model_results = concrete_results$df %>% mutate(qtype="concrete") %>%
# #   rbind(inductive_results$df %>% mutate(qtype="inductive"))
# # priors_results$p
# # ggsave("l0_fit_to_givanumber_et_al_prior.png", width=15, height=3)
# ```
# 
# ```{r, fig.width=10, fig.height=4}
# # priors_results$fit %>%
# #   ggplot(aes(x=value)) +
# #   geom_histogram(bins=15) +
# #   facet_wrap(variable ~object, ncol=5, scales="free")
# ```
# 
# 
# ```{r, fig.width=10, fig.height=5}
# # l0_model_results %>%
# #     ggplot() +
# #     aes(x=dollar_amount, y=y, ymin=ymin, ymax=ymax, colour=src) +
# #     geom_pointrange() +
# #     facet_wrap(qtype~object, scale="free_x", ncol = 5) +
# #     ylim(0, 1) +
# #     scale_colour_solarized()
# # ggsave("l0_giveanumber_et_al.png", width=10, height=5)
# ```
# 
# ```{r, fig.width=10, fig.height=5}
# # l0_model_results %>%
# #   filter(src=="model") %>%
# #   rbind(expt_results) %>%
# #   gather("var", "val", c(y, ymin, ymax)) %>%
# #   unite("tmp", src, var, sep=".") %>%
# #   spread(tmp, val) %>%
# #   filter(expt_id=="11") %>%
# #   ggplot() +
# #   aes(x=model.y, xmin=model.ymin, xmax=model.ymax,
# #       y=data.y, ymin=data.ymin, ymax=data.ymax,
# #       colour=object) +
# #   ylab("Data") +
# #   xlab("Model") +
# #   geom_pointrange() +
# #   geom_errorbarh() +
# #   scale_colour_solarized() +
# #   geom_text_repel(aes(label=dollar_amount)) +
# #   facet_wrap(expt_id ~ qtype, scales="free")
# # ggsave("l0_expt11.png", width=10, height=5)
# #
# # l0_model_results %>%
# #   filter(src=="model") %>%
# #   rbind(expt_results) %>%
# #   gather("var", "val", c(y, ymin, ymax)) %>%
# #   unite("tmp", src, var, sep=".") %>%
# #   spread(tmp, val) %>%
# #   filter(expt_id=="11") %>%
# #   group_by(qtype) %>%
# #   summarise(rsquared = cor(model.y, data.y)^2)
# ```
# 
# ```{r, fig.width=10, fig.height=5}
# # l0_model_results %>%
# #   filter(src=="model") %>%
# #   rbind(expt_results) %>%
# #   gather("var", "val", c(y, ymin, ymax)) %>%
# #   unite("tmp", src, var, sep=".") %>%
# #   spread(tmp, val) %>%
# #   ggplot() +
# #   aes(x=model.y, xmin=model.ymin, xmax=model.ymax,
# #       y=data.y, ymin=data.ymin, ymax=data.ymax,
# #       colour=object) +
# #   ylab("Data") +
# #   xlab("Model") +
# #   geom_pointrange() +
# #   geom_errorbarh() +
# #   scale_colour_solarized() +
# #   # geom_text_repel(aes(label=dollar_amount)) +
# #   facet_wrap(~qtype, scales="free")
# # ggsave("l0_all.png", width=10, height=5)
# #
# # l0_model_results %>%
# #   filter(src=="model") %>%
# #   rbind(expt_results) %>%
# #   gather("var", "val", c(y, ymin, ymax)) %>%
# #   unite("tmp", src, var, sep=".") %>%
# #   spread(tmp, val) %>%
# #   group_by(qtype) %>%
# #   summarise(rsquared = cor(model.y, data.y)^2)
# ```
# 
# ```{r, fig.width=10, fig.height=20}
#  # l0_model_results %>%
#  #    gather("var", "val", c(y, ymin, ymax)) %>%
#  #    unite("tmp", src, var, sep=".") %>%
#  #    spread(tmp, val) %>%
#  #    ggplot() +
#  #    aes(x=model.y, xmin=model.ymin, xmax=model.ymax,
#  #        y=data.y, ymin=data.ymin, ymax=data.ymax,
#  #        colour=object) +
#  #    ylab("Data") +
#  #    xlab("Model") +
#  #    geom_abline(slope = 1, intercept = 0, alpha=0.2) +
#  #    geom_pointrange() +
#  #    geom_errorbarh() +
#  #    scale_colour_solarized() +
#  #  xlim(0, 1) +
#  #  ylim(0, 1) +
#  #  # geom_text_repel(aes(label=dollar_amount)) +
#  #  facet_grid(expt_id ~ qtype)
# ```
# 
# ```{r}
# # concrete_results$R_squared
# # inductive_results$R_squared
# ```
# 
# 
# ```{r}
# # expt_results = df %>%
# #   group_by(id, workerid) %>%
# #   mutate(zscore = scale(response)) %>%
# #   group_by(id, qtype, object, dollar_amount) %>%
# #   do(mean_cl_boot(.$zscore)) %>%
# #   rename(expt_id = id) %>%
# #   mutate(src = "data") %>%
# #   ungroup()
# ```
# 
# 
# ```{r, fig.width=10, fig.height=20}
# # l0_model_results %>%
# #   filter(src=="model") %>%
# #   rbind(expt_results) %>%
# #   gather("var", "val", c(y, ymin, ymax)) %>%
# #   unite("tmp", src, var, sep=".") %>%
# #   spread(tmp, val) %>%
# #   ggplot() +
# #   aes(x=model.y, xmin=model.ymin, xmax=model.ymax,
# #       y=data.y, ymin=data.ymin, ymax=data.ymax,
# #       colour=object) +
# #   ylab("Data") +
# #   xlab("Model") +
# #   geom_pointrange() +
# #   geom_errorbarh() +
# #   scale_colour_solarized() +
# #   # geom_text_repel(aes(label=dollar_amount)) +
# #   facet_grid(expt_id ~ qtype)
# ```
# 
# 
# ```{r, fig.width=10, fig.height=5}
# # # this takes ~100 minutes to run
# # model_results_file = "../models/results/results-S1-5000_burn2500_lag10_chain1_concrete_giveanumber_inductive_all_listener1.csv"
# # priors_results = plot_priors(model_results_file)
# # concrete_results = plot_concrete(model_results_file)
# # inductive_results = plot_inductive(model_results_file)
# # l1_model_results = concrete_results$df %>% mutate(qtype="concrete") %>%
# #   rbind(inductive_results$df %>% mutate(qtype="inductive"))
# #
# # l1_model_results %>%
# #     ggplot() +
# #     aes(x=dollar_amount, y=y, ymin=ymin, ymax=ymax, colour=src) +
# #     geom_pointrange() +
# #     facet_wrap(qtype~object, scale="free_x", ncol = 5) +
# #     ylim(0, 1) +
# #     scale_colour_solarized()
# ```
# 
# ```{r}
# # concrete_results$R_squared
# # inductive_results$R_squared
# ```
# 
# 
# ```{r, fig.width=10, fig.height=20}
# # l1_model_results %>%
# #   filter(src=="model") %>%
# #   rbind(expt_results) %>%
# #   gather("var", "val", c(y, ymin, ymax)) %>%
# #   unite("tmp", src, var, sep=".") %>%
# #   spread(tmp, val) %>%
# #   ggplot() +
# #   aes(x=model.y, xmin=model.ymin, xmax=model.ymax,
# #       y=data.y, ymin=data.ymin, ymax=data.ymax,
# #       colour=object) +
# #   ylab("Data") +
# #   xlab("Model") +
# #   geom_pointrange() +
# #   geom_errorbarh() +
# #   scale_colour_solarized() +
# #   geom_text_repel(aes(label=dollar_amount)) +
# #   facet_grid(expt_id ~ qtype)
# ```
# 
# ```{r}
# # #L0 vs L1
# # l0_vs_l1 = l0_model_results %>% mutate(listener_level = "L0") %>%
# #   rbind(l1_model_results %>% mutate(listener_level = "L1")) %>%
# #   filter(qtype=="inductive") %>%
# #   filter(src=="model") %>%
# #   gather("var", "val", c(y, ymin, ymax)) %>%
# #   unite("tmp", listener_level, var, sep=".") %>%
# #   spread(tmp, val)
# # cor(l0_vs_l1$L0.y, l0_vs_l1$L1.y)^2
# # l0_vs_l1 %>%
# #   ggplot(aes(x=L0.y, y=L1.y, colour=object)) +
# #   geom_point() +
# #   scale_colour_solarized()
# # ggsave("l0_vs_l1.png", width=5, height=3)
# ```
# 
# ```{r, fig.width=10, fig.height=5}
# # l1_model_results %>%
# #   filter(src=="model") %>%
# #   rbind(expt_results) %>%
# #   gather("var", "val", c(y, ymin, ymax)) %>%
# #   unite("tmp", src, var, sep=".") %>%
# #   spread(tmp, val) %>%
# #   filter(expt_id=="11") %>%
# #   ggplot() +
# #   aes(x=model.y, xmin=model.ymin, xmax=model.ymax,
# #       y=data.y, ymin=data.ymin, ymax=data.ymax,
# #       colour=object) +
# #   ylab("Data") +
# #   xlab("Model") +
# #   geom_pointrange() +
# #   geom_errorbarh() +
# #   scale_colour_solarized() +
# #   geom_text_repel(aes(label=dollar_amount)) +
# #   facet_wrap(expt_id ~ qtype, scales="free")
# ```
# 
# 
# 
# 
# ```{r, fig.width=10, fig.height=5}
# # model_results_file = "../models/results/results-S1-5000_burn2500_lag10_chain1_giveanumber_all_listener1.csv"
# # priors_results = plot_priors(model_results_file)
# # concrete_results = plot_concrete(model_results_file)
# # inductive_results = plot_inductive(model_results_file)
# # l1_model_results = concrete_results$df %>% mutate(qtype="concrete") %>%
# #   rbind(inductive_results$df %>% mutate(qtype="inductive"))
# #
# # l1_model_results %>%
# #     ggplot() +
# #     aes(x=dollar_amount, y=y, ymin=ymin, ymax=ymax, colour=src) +
# #     geom_pointrange() +
# #     facet_wrap(qtype~object, scale="free_x", ncol = 5) +
# #     ylim(0, 1) +
# #     scale_colour_solarized()
# ```
# 
# ```{r}
# # concrete_results$R_squared
# # inductive_results$R_squared
# ```
# 
# 
# ```{r, fig.width=10, fig.height=20}
# # l1_model_results %>%
# #   filter(src=="model") %>%
# #   rbind(expt_results) %>%
# #   gather("var", "val", c(y, ymin, ymax)) %>%
# #   unite("tmp", src, var, sep=".") %>%
# #   spread(tmp, val) %>%
# #   ggplot() +
# #   aes(x=model.y, xmin=model.ymin, xmax=model.ymax,
# #       y=data.y, ymin=data.ymin, ymax=data.ymax,
# #       colour=object) +
# #   ylab("Data") +
# #   xlab("Model") +
# #   geom_pointrange() +
# #   geom_errorbarh() +
# #   scale_colour_solarized() +
# #   geom_text_repel(aes(label=dollar_amount)) +
# #   facet_grid(expt_id ~ qtype)
# ```
# 
# 
# 
# 
# 
# 
# 
# 
# ## Concrete premise
# 
# ```{r, fig.height=2, fig.width=10}
# # concrete_concrete = plot_concrete("../models/results/results-S1-5000_burn2500_lag10_chain1_concrete.csv")
# # # print(concrete_concrete$plot_responses)
# ```
# 
# ```{r}
# # print(concrete_concrete$plot_correlation)
# 
# # Fitting just to concrete data, $R^2 = `r round(concrete_concrete[["R_squared"]], 3)`$.
# 
# # concrete_concrete_giveanumber = plot_concrete("../models/results/results-S1-5000_burn2500_lag10_chain1_concrete_giveanumber.csv")
# 
# # Additionally fitting to giveanumber data, $R^2 = `r round(concrete_concrete_giveanumber[["R_squared"]], 3)`$.
# #
# # {r, fig.height=2, fig.width=10}
# # print(concrete_concrete_giveanumber$plot_responses)
# ```
# 
# ```{r}
# # print(concrete_concrete_giveanumber$plot_correlation)
# ```
# 
# ```{r}
# # concrete_giveanumber = plot_concrete("../models/results/results-S1-5000_burn2500_lag10_chain1_giveanumber.csv")
# ```
# 
# <!-- *Only* fitting to giveanumber data, $R^2 = `r round(concrete_giveanumber[["R_squared"]], 3)`$. -->
# 
# ```{r, fig.height=2, fig.width=10}
# # print(concrete_giveanumber$plot_responses)
# ```
# 
# ```{r}
# # print(concrete_giveanumber$plot_correlation)
# ```
# 
# 
# ```{r, fig.width=10, fig.height=2}
# # prior_concrete = plot_priors("../models/results/results-S1-5000_burn2500_lag10_chain1_concrete.csv")
# # # print(prior_concrete$p)
# ```
# 
# <!-- Fitting to the concrete premise only, the fit to the *prior* price distributions in the giveanumber experiment is $R^2 = `r round(prior_concrete[["R_squared"]], 3)`$. -->
# 
# ```{r}
# # question: does prior fit get worse over time? (hypothesis: prices are changing over time for these items)
# ```
# 
# <!-- ## Inductive
# 
# Now to model the indutive premise... -->
# 
# ```{r}
# # inductive = df %>%
# #   filter(qtype=="inductive") %>%
# #   select(id, object, dollar_amount, response) %>%
# #   rename(expt_id = id) %>%
# #   group_by(expt_id, dollar_amount, object) %>%
# #   do(mean_cl_boot(.$response/9)) %>%
# #   ungroup() %>%
# #   mutate(src = "data")
# #
# # epsilons = inductive %>%
# #   group_by(expt_id, object, dollar_amount) %>%
# #   summarise()
# ```
# 
# ```{r}
# # inductive %>%
# #     ggplot() +
# #     aes(x=dollar_amount, y=y, ymin=ymin, ymax=ymax, colour=src) +
# #     geom_pointrange() +
# #     facet_wrap(~object, scale="free_x", ncol = 5) +
# #     ylim(0, 1) +
# #     scale_colour_solarized()
# ```
# 
# <!-- As a first pass, I'm just taking the expectation over L0 of the inductive premise being true. -->
# 
# ```{r}
# # model_results_file = "../models/results/results-S1-5000_burn2500_lag10_chain5_concrete_giveanumber_inductive.csv"
# #
# # l0_comparison = read.csv(model_results_file,
# #                   col.names = c("result_type", "dollar_amount",
# #                                 "expt_id", "object",
# #                                 "value", "probability")) %>%
# #   filter(result_type == "Inductive") %>%
# #   group_by(expt_id, object, dollar_amount) %>%
# #   do(quantile_errorbars(.$value)) %>%
# #   ungroup() %>%
# #   mutate(dollar_amount = num(dollar_amount)) %>%
# #   mutate(src="model") %>%
# #   rbind(inductive)
# ```
# 
# ```{r, fig.height=2, fig.width=10}
# # l0_comparison %>%
# #     ggplot() +
# #     aes(x=dollar_amount, y=y, ymin=ymin, ymax=ymax, colour=src) +
# #     geom_pointrange() +
# #     facet_wrap(~object, scale="free_x", ncol = 5) +
# #     ylim(0, 1) +
# #     scale_colour_solarized()
# ```
# 
# ```{r}
# # R_squared = l0_comparison %>%
# #   select(-c(ymin, ymax)) %>%
# #   spread(src, y) %>%
# #   lm(data~model, data=.) %>%
# #   summary() %>%
# #   .$r.squared
# ```
# 
# 
# ```{r}
# # concrete_concrete_giveanumber_inductive = plot_concrete("../models/results/results-S1-5000_burn2500_lag10_chain5_concrete_giveanumber_inductive.csv")
# ```
# 
# <!-- Additionally fitting to giveanumber data, $R^2 = `r round(concrete_concrete_giveanumber_inductive[["R_squared"]], 3)`$. -->
# 
# ```{r, fig.height=2, fig.width=10}
# # print(concrete_concrete_giveanumber_inductive$plot_responses)
# ```
# 
# ```{r}
# # print(concrete_concrete_giveanumber_inductive$plot_correlation)
# ```
# 
# ```{r}
# # full_concrete_giveanumber_inductive_comparison = rbind(concrete_concrete_giveanumber_inductive$concrete_comparison %>% mutate(qtype = "concrete"),
# # l0_comparison %>% mutate(qtype = "inductive"))
# # full_concrete_giveanumber_inductive_comparison %>%
# #     gather("var", "val", c(y, ymin, ymax)) %>%
# #     unite("tmp", src, var, sep=".") %>%
# #     spread(tmp, val) %>%
# #     ggplot() +
# #     aes(x=model.y, xmin=model.ymin, xmax=model.ymax,
# #         y=data.y, ymin=data.ymin, ymax=data.ymax,
# #         colour=qtype) +
# #     ylab("Data") +
# #     xlab("Model") +
# #     geom_abline(slope = 1, intercept = 0, alpha=0.2) +
# #     geom_errorbarh() +
# #     geom_pointrange() +
# #   scale_color_solarized()
# # ggsave("bda_correlations.png")
# ```
# 
# ```{r}
# # full_concrete_giveanumber_inductive_comparison %>%
# #   select(-c(ymin, ymax)) %>%
# #   spread(src, y) %>%
# #   lm(data~model, data=.) %>%
# #   summary() %>%
# #   .$r.squared
# ```
# 
# 
# 
# ```{r, fig.width=10, fig.height=5}
# # full_concrete_giveanumber_inductive_comparison %>%
# #     ggplot() +
# #     aes(x=dollar_amount, y=y, ymin=ymin, ymax=ymax, colour=src) +
# #     geom_pointrange() +
# #     facet_wrap(qtype~object, scale="free_x", ncol = 5) +
# #     ylim(0, 1) +
# #     scale_colour_solarized()
# # ggsave("bda_data.png", width=10, height=5)
```


## Checks of convergence

```{r, fig.width=4, fig.height=4}
read.csv(
  model_results_file,
  col.names = c("result_type", "specifics",
                "expt_id", "object",
                "value", "probability")) %>%
  filter(result_type == "price_prior") %>%
  ggplot(aes(x=value)) +
  geom_histogram() +
  facet_wrap(specifics ~ object)
```

```{r, fig.width=2, fig.height=1.5}
read.csv(
  model_results_file,
  col.names = c("result_type", "specifics",
                "expt_id", "object",
                "value", "probability")) %>%
  filter(result_type == "global_param") %>%
  ggplot(aes(x=value)) +
  geom_histogram() +
  facet_wrap(~specifics)
```



```{r, fig.width=5, fig.height=20}
read.csv(
  model_results_file,
  col.names = c("result_type", "dollar_amount",
                "expt_id", "object",
                "value", "probability")) %>%
  filter(result_type == "Inductive") %>%
  ggplot(aes(x=value)) +
  geom_histogram(bins=30) +
  facet_wrap(dollar_amount~object, ncol = 5, scales="free")
```
